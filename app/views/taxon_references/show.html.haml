.container
  .row
    .breadcrumbs
      %strong= link_to "&laquo back to taxon references".html_safe, taxon_references_path, :class => 'crumb'
    .col-xs-8.prepend-8
      -if @taxon_reference.relationship == "unknown"
        .alert
          There's something wrong here - we can't determine the relationship between any local and external taxa
      .panel.panel-default
        .panel-heading
          - if @taxon_reference.relationship == "not local"
            %h4 Taxon Reference for Non-local Taxon
          - elsif @taxon_reference.relationship == "unknown"
            %h4 Taxon Reference with Unknown Relationship
          - else
            %h4 Taxon Reference for #{link_to @taxon_reference.taxa.first.name, taxonomy_details_for_taxon_path(@taxon_reference.taxa.first)}
        .panel-body
          - if is_curator?
            - if ( @taxon_reference.concept.taxon_curators.count > 0 && @taxon_reference.concept.taxon_curators.select{|tc| tc.user_id == current_user.id } ) || ( @taxon_reference.concept.taxon_curators.count == 0 )
              .pull-right
                = link_to "Edit reference", edit_taxon_reference_path(@taxon_reference)
          Covered by a #{link_to "Concept Framework for #{@taxon_reference.concept.taxon.name}", taxonomy_details_for_taxon_path(@taxon_reference.concept.taxon)}
          referencing #{link_to @taxon_reference.concept.source.title, @taxon_reference.concept.source.url} 
          = render :partial => 'show_taxon_reference', object: { taxon_reference: @taxon_reference }
          - unless @taxon_reference.description.blank?
            = formatted_user_text @taxon_reference.description, tags: Post::ALLOWED_TAGS, attributes: Post::ALLOWED_ATTRIBUTES
