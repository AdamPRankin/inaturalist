$.fn.observationFieldAutocomplete = function( options ) {
  options = options || { };
  if( !options.idEl ) { return; }
  var field = this;

  field.genericAutocomplete( _.extend( options, {
    source: function( request, response ) {
      $.ajax({
      url: "//<%= CONFIG.node_api_host %>/observation_fields/autocomplete",
        dataType: "jsonp",
        cache: true,
        jsonpCallback: "observationFieldAutocompleteCallback",
        data: {
          q: request.term,
          per_page: 10
        },
        success: function( data ) {
          response( _.map(data.results, function(r) {
            return Object.assign( { }, r, { title: r.name } );
          } ) );
        }
      });
    }
  }));
};
